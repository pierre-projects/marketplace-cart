<!DOCTYPE html>
<html>
<head>
  <title>My Categories</title>
  <link rel="stylesheet" href="/css/style.css">
</head>
<body>
  <%- include('../partials/navbar') %>

  <main class="container">
    <div class="page-header">
      <h1>My Categories</h1>
      <form action="/categories/create" method="POST" class="create-category-form">
        <input type="text" name="name" placeholder="New category name" required>
        <button type="submit" class="btn-primary">+ Create</button>
      </form>
    </div>

    <!-- Your Categories -->
    <% const userCategories = categories.filter(c => c.name !== 'All Listings'); %>

    <% if (userCategories.length === 0) { %>
      <div class="empty-state">
        <p>You haven't created any categories yet.</p>
        <p class="muted">Create one above to start organizing your listings.</p>
      </div>
    <% } else { %>
      <div class="category-grid">
        <% userCategories.forEach(category => { %>
          <div class="category-card">
            <a href="/categories/<%= category._id %>" class="category-card-link">
              <h3 class="category-name"><%= category.name %></h3>
              <p class="category-meta"><%= category.items.length %> item<%= category.items.length !== 1 ? 's' : '' %></p>
            </a>
            <button type="button" class="manage-btn"
              data-id="<%= category._id %>"
              data-name="<%= category.name %>">
              Manage
            </button>
          </div>
        <% }) %>
      </div>
    <% } %>

    <!-- Shared With Me -->
    <% if (sharedCategories && sharedCategories.length > 0) { %>
      <h2 class="section-title">Shared With Me</h2>
      <div class="category-grid">
        <% sharedCategories.forEach(category => { %>
          <div class="category-card category-card--shared">
            <a href="/categories/<%= category._id %>" class="category-card-link">
              <span class="shared-badge">Shared</span>
              <h3 class="category-name"><%= category.name %></h3>
              <p class="category-meta"><%= category.items.length %> item<%= category.items.length !== 1 ? 's' : '' %></p>
            </a>
          </div>
        <% }) %>
      </div>
    <% } %>
  </main>

  <!-- Manage Category Modal -->
  <div id="manageCategoryModal" class="modal-overlay" style="display:none;">
    <div class="modal-content modal-sm">
      <div class="modal-header">
        <h2>Manage Category</h2>
        <button type="button" class="modal-close">&times;</button>
      </div>
      <div class="modal-body">
        <form id="renameForm" class="modal-form">
          <label for="newName">Rename</label>
          <div class="input-group">
            <input type="text" id="newName" name="name" required>
            <button type="submit" class="btn-primary">Save</button>
          </div>
        </form>
        <hr class="modal-divider">
        <div class="danger-zone">
          <p class="danger-label">Danger Zone</p>
          <button type="button" id="deleteBtn" class="btn-danger">Delete Category</button>
          <p class="danger-warning">This will remove the category but not the items.</p>
        </div>
      </div>
    </div>
  </div>

  <script src="/js/categories.js"></script>
</body>
</html>
